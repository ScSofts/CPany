import{P as e,V as t}from"./index.e167d4e5.js";import{i as s,e as a,B as r,C as n,j as o,x as i,o as p,b as l,m as c,d as m,t as d,u,A as f}from"./vendor.5658d620.js";import{l as T}from"./load.8c215a92.js";import{c as b}from"./codeforces.9e4da7d5.js";import{_ as y,h as v,f as h}from"./Contest.bd72100d.js";import"./c-table.265c75f7.js";import"./user-link.69187dfa.js";import"./cf-rating-color.d2c4e464.js";import"./at-rating-color.ce5fb119.js";const j=T(b),C=new Map;for(const w of j)w.type.startsWith("codeforces")&&C.set(w.id,w);const g={key:0},I={key:1,class:"divide-y"},A=m("h2",{class:"mb-2"},"错误",-1),S={class:"pt-2"},P=a({setup(a){const T=r(),b=n(),j=o(null),P=o(!1),{start:w,end:x}=function(){const e=s("loading");return{start(){e.value=!0},end(){e.value=!1}}}();return i((()=>T.params),(s=>{if(s.id){const n=(a=+s.id,null!=(r=C.get(+a))?r:null);if(null!==n)j.value=n,(async s=>{var a,r;w();const n=new URL("https://codeforces.com/api/contest.standings");n.searchParams.append("contestId",""+s.id),n.searchParams.append("handles",v.map((({h:e})=>e)).join(";")),n.searchParams.append("showUnofficial","true");const{result:o}=await(await fetch(n.toString())).json();s.problems=o.problems;for(const e of o.problems)e.problemUrl=`https://codeforces.com/contest/${e.contestId}/problem/${e.index}`;s.standings=[];for(const i of o.rows){if(i.party.participantType!==e.CONTESTANT&&i.party.participantType!==e.VIRTUAL&&i.party.participantType!==e.OUT_OF_COMPETITION&&i.party.participantType!==e.PRACTICE)continue;const n=i.problemResults.reduce(((e,t)=>{var s,a;return 0===t.points?e:e+(null!=(s=t.bestSubmissionTimeSeconds)?s:0)+20*(null!=(a=t.rejectedAttemptCount)?a:0)}),0),o=null!=(a=i.party.participantTime)?a:s.startTime;s.standings.push({author:{members:i.party.members.map((e=>e.handle)),teamName:null!=(r=i.party.teamName)?r:h(i.party.members[0].handle),participantTime:o,participantType:i.party.participantType},rank:i.rank,solved:i.problemResults.filter((e=>e.points>0)).length,penalty:n,submissions:i.problemResults.map(((e,s)=>{const a=e.bestSubmissionTimeSeconds+o,r=e.bestSubmissionTimeSeconds;return e.points>0?{id:-1,creationTime:a,relativeTime:r,problemIndex:s,verdict:t.OK,dirty:e.rejectedAttemptCount}:e.rejectedAttemptCount>0?{id:-1,creationTime:a,relativeTime:r,problemIndex:s,dirty:e.rejectedAttemptCount}:null})).filter((e=>null!==e))})}x()})(j.value),document.title=`${n.name} - CPany`;else{P.value=!0;const e=setTimeout((()=>b.replace({name:"Home"})),3e3);f((()=>clearTimeout(e)))}}var a,r}),{immediate:!0}),(e,t)=>(p(),l("div",null,[j.value&&!P.value?(p(),l("div",g,[c(y,{contest:j.value},null,8,["contest"])])):(p(),l("div",I,[A,m("p",S,"未找到 ID 为 "+d(u(T).params.id)+" 的 Codeforces 比赛",1)]))]))}});export{P as default};
