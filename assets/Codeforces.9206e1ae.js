import{P as t,V as e}from"./index.f369c5cf.js";import{i as a,e as s,B as n,C as o,j as r,x as i,o as c,b as p,m as l,d as m,t as d,u,h as f,A as y}from"./vendor.5658d620.js";import{l as T}from"./load.8c215a92.js";import{c as b}from"./codeforces.9e4da7d5.js";import{_ as h,h as v,f as j}from"./Contest.5ec73a48.js";import"./c-table.ca692e51.js";import"./user-link.69187dfa.js";import"./cf-rating-color.d52f793a.js";import"./at-rating-color.56f5424d.js";const C=T(b),g=new Map;for(const R of C)R.type.startsWith("codeforces")&&g.set(R.id,R);const w={key:0},S={key:1,class:"divide-y"},I=m("h2",{class:"mb-2"},"错误",-1),A={class:"pt-2"},P=s({setup(s){const T=n(),b=o(),C=r(null),P=r(!1),{start:R,end:U}=function(){const t=a("loading");return{start(){t.value=!0},end(){t.value=!1}}}(),N=async a=>{var s,n;const o=new URL("https://codeforces.com/api/contest.standings");o.searchParams.append("contestId",""+a.id),o.searchParams.append("handles",v.map((({h:t})=>t)).join(";")),o.searchParams.append("showUnofficial","true");const{result:r}=await(await fetch(o.toString())).json();let i=0;a.problems=r.problems;for(const t of r.problems)t.problemUrl=`https://codeforces.com/contest/${t.contestId}/problem/${t.index}`;a.standings=[];for(const c of r.rows){if(c.party.participantType!==t.CONTESTANT&&c.party.participantType!==t.VIRTUAL&&c.party.participantType!==t.OUT_OF_COMPETITION&&c.party.participantType!==t.PRACTICE)continue;c.party.participantType!==t.PRACTICE&&i++;const o=c.problemResults.reduce(((t,e)=>{var a,s;return 0===e.points?t:t+(null!=(a=e.bestSubmissionTimeSeconds)?a:0)+20*(null!=(s=e.rejectedAttemptCount)?s:0)}),0),r=null!=(s=c.party.participantTime)?s:a.startTime;a.standings.push({author:{members:c.party.members.map((t=>t.handle)),teamName:null!=(n=c.party.teamName)?n:j(c.party.members[0].handle),participantTime:r,participantType:c.party.participantType},rank:c.rank,solved:c.problemResults.filter((t=>t.points>0)).length,penalty:o,submissions:c.problemResults.map(((t,a)=>{const s=t.bestSubmissionTimeSeconds+r,n=t.bestSubmissionTimeSeconds;return t.points>0?{id:-1,creationTime:s,relativeTime:n,problemIndex:a,verdict:e.OK,dirty:t.rejectedAttemptCount}:t.rejectedAttemptCount>0?{id:-1,creationTime:s,relativeTime:n,problemIndex:a,dirty:t.rejectedAttemptCount}:null})).filter((t=>null!==t))})}a.participantNumber=i};return i((()=>T.params),(async t=>{if(t.id){R();const s=(e=+t.id,null!=(a=g.get(+e))?a:null);if(null!==s)C.value=s,await N(C.value),U(),document.title=`${s.name} - CPany`;else{const e=await(async t=>{const e=new URL("https://codeforces.com/api/contest.list"),{result:a}=await(await fetch(e.toString())).json();for(const s of a)if(s.id===t)return{type:"codeforces",name:s.name,startTime:s.startTimeSeconds,duration:s.durationSeconds,participantNumber:0,id:s.id,phase:s.phase,contestUrl:`https://codeforces.com/contest/${s.id}`,standingsUrl:`https://codeforces.com/contest/${s.id}/standings`}})(+t.id);if(e)C.value=e,N(C.value),document.title=`${e.name} - CPany`;else{P.value=!0;const t=setTimeout((()=>b.replace({name:"Home"})),3e3);y((()=>clearTimeout(t)))}}U()}var e,a}),{immediate:!0}),(t,e)=>(c(),p("div",null,[C.value&&!P.value?(c(),p("div",w,[l(h,{contest:C.value},null,8,["contest"])])):P.value?(c(),p("div",S,[I,m("p",A,"未找到 ID 为 "+d(u(T).params.id)+" 的 Codeforces 比赛",1)])):f("v-if",!0)]))}});export{P as default};
